<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>手写 call</title>
</head>
<body>
  <script>
    // 手写call
    Function.prototype.myCall = function(context) {
      if(typeof this !== "function") {
        console.error("type error")
      }
      let args = [...arguments].slice(1),
        result = null;
      context = context || window
      console.log(context)
      console.log(arguments)
      console.log(args)

      //this指fn1，把fn1方法给到obj的fn上
      context.fn = this 
      result = context.fn(...args);
      delete context.fn;
      return result
    }

    // 验证
    // const first = "windw-Lppp";
    // const second = "windw-Sea9";

    const obj = {
      full: function(txt) {
        console.log(`${txt} + ${this.first} + ${this.second}`)
      }
    }
    const obj1 = {
      first: "Lppp",
      second: "Sea9"
    }
    obj.full.myCall(obj1,"Hello","Hello2")
    // obj.full.myApply(obj1,["Hello","Hello2"])


    // 手写apply
    Function.prototype.myApply = function(context) {
      if(typeof this !== "function") {
        console.error("Error")
      }
      let result = null;

      context = context || window;

      context.fn = this;

      if(arguments[1]) {
        result = context.fn(...arguments[1]);
      } else {
        result = context.fn()
      }

      delete context.fn;

      return result;
    }

    // 实现 bind
    Function.prototype.myBind = function(context) {
      if(typeof this !== 'function') {
        throw new TypeError("Error")
      }
      // 获取参数
      var args = [...arguments].slice(1),
        fn = this;
      
      return function Fn() {
        return fn.apply(this instanceof Fn ? this : context, args.concat(...arguments));
      }
    }

  </script>
</body>
</html>